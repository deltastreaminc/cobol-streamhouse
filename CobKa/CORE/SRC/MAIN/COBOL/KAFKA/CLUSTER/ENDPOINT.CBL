IDENTIFICATION DIVISION.
PROGRAM-ID. ENDPOINT-PROGRAM.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
REPOSITORY.
    FUNCTION ALL INTRINSIC.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-ENDPOINT.
   05 WS-HOST PIC X(256).
   05 WS-PORT PIC 9(5) BINARY.
   05 WS-LISTENER-NAME PIC X(256).
   05 WS-SECURITY-PROTOCOL PIC X(256).
01 WS-CONNECTIONSTRING PIC X(512).

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    PERFORM PARSE-LISTENER-NAME.
    PERFORM CREATE-ENDPOINT.
    PERFORM CREATE-JAVA-ENDPOINT.
    STOP RUN.

PARSE-LISTENER-NAME.
    MOVE FUNCTION UPPER-CASE(WS-LISTENER-NAME) TO WS-LISTENER-NAME.
    MOVE FUNCTION FIND-STRING(WS-LISTENER-NAME, ":", 1) TO WS-PORT.
    IF WS-PORT = 0
        RAISE EXCEPTION USING "UNABLE TO PARSE A LISTENER NAME"
    END-IF.
    MOVE FUNCTION SUBSTRING(WS-LISTENER-NAME, 1, WS-PORT - 1) TO WS-LISTENER-NAME.

CREATE-ENDPOINT.
    MOVE WS-HOST TO ENDPOINT-HOST.
    MOVE WS-PORT TO ENDPOINT-PORT.
    MOVE WS-LISTENER-NAME TO ENDPOINT-LISTENER-NAME.
    MOVE WS-SECURITY-PROTOCOL TO ENDPOINT-SECURITY-PROTOCOL.

CREATE-JAVA-ENDPOINT.
    MOVE ENDPOINT-LISTENER-NAME TO JAVA-ENDPOINT-LISTENER-NAME.
    MOVE ENDPOINT-SECURITY-PROTOCOL TO JAVA-ENDPOINT-SECURITY-PROTOCOL.
    MOVE ENDPOINT-HOST TO JAVA-ENDPOINT-HOST.
    MOVE ENDPOINT-PORT TO JAVA-ENDPOINT-PORT.
    CALL "CREATE-JAVA-ENDPOINT" USING JAVA-ENDPOINT-LISTENER-NAME,
                                     JAVA-ENDPOINT-SECURITY-PROTOCOL,
                                     JAVA-ENDPOINT-HOST,
                                     JAVA-ENDPOINT-PORT.