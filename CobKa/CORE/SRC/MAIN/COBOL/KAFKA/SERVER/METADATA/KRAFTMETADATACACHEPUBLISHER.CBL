IDENTIFICATION DIVISION.
PROGRAM-ID. KRAFT-METADATA-CACHE-PUBLISHER.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
REPOSITORY.
    COPY METADATA-DELTA, METADATA-IMAGE, LOADER-MANIFEST.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 METADATA-CACHE PIC X(30).
01 DELTA-FIELD PIC X(20).
01 NEW-IMAGE-FIELD PIC X(20).
01 MANIFEST-FIELD PIC X(20).

PROCEDURE DIVISION.
MAIN-PARAGRAPH.
    MOVE "KRaftMetadataCachePublisher" TO METADATA-CACHE.
    MOVE "onMetadataUpdate" TO PROCEDURE-NAME.

PROCEDURE-NAME.
    MOVE DELTA-FIELD TO METADATA-DELTA.
    MOVE NEW-IMAGE-FIELD TO METADATA-IMAGE.
    MOVE MANIFEST-FIELD TO LOADER-MANIFEST.
    CALL "SET-IMAGE" USING METADATA-CACHE, METADATA-IMAGE.
    STOP RUN.