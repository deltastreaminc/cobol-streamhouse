IDENTIFICATION DIVISION.
PROGRAM-ID. KRAFTMETADATACACHE.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
REPOSITORY.
    COPY KAFKA-SERVER-METADATA.

DATA DIVISION.
WORKING-STORAGE SECTION.
   01 WS-CURRENT-IMAGE PIC X(32768) VALUE SPACES.
   01 WS-BROKERID PIC 9(10) BINARY.
   01 WS-KRAFTVERSIONSUPPLIER PIC X(32768) VALUE SPACES.
   01 WS-LOGIDENT PIC X(100) VALUE "[MetadataCache brokerId=".

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    MOVE BROKERID TO WS-BROKERID.
    MOVE KRAFTVERSIONSUPPLIER TO WS-KRAFTVERSIONSUPPLIER.
    PERFORM MAYBEFILTERALIVELOGICALREPLICAS.
    PERFORM GETPARTITIONMETADATA.
    PERFORM GETPARTITIONMETADATAFORDESCRIBETOPICRESPONSE.
    PERFORM GETOFFLINEREPLICASLIST.
    PERFORM GETALIVEENDPOINT.
    PERFORM GETTOPICMETADATA.
    PERFORM DESCRIBETOPICRESPONSE.
    PERFORM GETALLTOPICS.
    PERFORM GETTOPICPARTITIONS.
    PERFORM GETTOPICID.
    PERFORM GETTOPICNAME.
    PERFORM HASALIVEBROKER.
    PERFORM ISBROKERSUBSTANTIALFENCE.
    PERFORM ISBROKUSHTINGOWN.
    PERFORM GETALIVEBROKERS.
    PERFORM GETALIVEBROKERSLIST.
    PERFORM GETLEADERANDISR.
    PERFORM GETPARTITIONSCOUNT.
    PERFORM TOPICNAMESTOIDSMAP.
    PERFORM TOPICIDSTONAMESMAP.
    PERFORM TOPICIDINFO.
    PERFORM GETPARTITIONLEADEREND.
    PERFORM GETPARTITIONREPLICAEND.
    PERFORM GETRANDOMALIVEBROKERID.
    PERFORM GETALIVEBROKEREPO.
    PERFORM GETCLUSTERMETADATA.
    PERFORM CONTAINSTOPIC.
    PERFORM CONTAINSTOPICPARTITION.
    PERFORM SETIMAGE.
    PERFORM GETIMAGE.
    PERFORM GETCONFIG.
    PERFORM DESCRIBELIENTQUOTAS.
    PERFORM DESCRIBESCRAMCREDENTIALS.
    PERFORM METADATAVERSION.
    PERFORM FEATURES.
    STOP RUN.

MAYBEFILTERALIVELOGICALREPLICAS.
    *> Implementation
    CONTINUE.

GETPARTITIONMETADATA.
    *> Implementation
    CONTINUE.

GETPARTITIONMETADATAFORDESCRIBETOPICRESPONSE.
    *> Implementation
    CONTINUE.

GETOFFLINEREPLICASLIST.
    *> Implementation
    CONTINUE.

GETALIVEENDPOINT.
    *> Implementation
    CONTINUE.

GETTOPICMETADATA.
    *> Implementation
    CONTINUE.

DESCRIBETOPICRESPONSE.
    *> Implementation
    CONTINUE.

GETALLTOPICS.
    *> Implementation
    CONTINUE.

GETTOPICPARTITIONS.
    *> Implementation
    CONTINUE.

GETTOPICID.
    *> Implementation
    CONTINUE.

GETTOPICNAME.
    *> Implementation
    CONTINUE.

HASALIVEBROKER.
    *> Implementation
    CONTINUE.

ISBROKERSUBSTANTIALFENCE.
    *> Implementation
    CONTINUE.

ISBROKUSHTINGOWN.
    *> Implementation
    CONTINUE.

GETALIVEBROKERS.
    *> Implementation
    CONTINUE.

GETALIVEBROKERSLIST.
    *> Implementation
    CONTINUE.

GETLEADERANDISR.
    *> Implementation
    CONTINUE.

GETPARTITIONSCOUNT.
    *> Implementation
    CONTINUE.

TOPICNAMESTOIDSMAP.
    *> Implementation
    CONTINUE.

TOPICIDSTONAMESMAP.
    *> Implementation
    CONTINUE.

TOPICIDINFO.
    *> Implementation
    CONTINUE.

GETPARTITIONLEADEREND.
    *> Implementation
    CONTINUE.

GETPARTITIONREPLICAEND.
    *> Implementation
    CONTINUE.

GETRANDOMALIVEBROKERID.
    *> Implementation
    CONTINUE.

GETALIVEBROKEREPO.
    *> Implementation
    CONTINUE.

GETCLUSTERMETADATA.
    *> Implementation
    CONTINUE.

CONTAINSTOPIC.
    *> Implementation
    CONTINUE.

CONTAINSTOPICPARTITION.
    *> Implementation
    CONTINUE.

SETIMAGE.
    *> Implementation
    CONTINUE.

GETIMAGE.
    *> Implementation
    CONTINUE.

GETCONFIG.
    *> Implementation
    CONTINUE.

DESCRIBELIENTQUOTAS.
    *> Implementation
    CONTINUE.

DESCRIBESCRAMCREDENTIALS.
    *> Implementation
    CONTINUE.

METADATAVERSION.
    *> Implementation
    CONTINUE.

FEATURES.
    *> Implementation
    CONTINUE.