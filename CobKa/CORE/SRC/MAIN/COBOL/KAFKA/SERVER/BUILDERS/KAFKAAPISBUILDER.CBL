IDENTIFICATION DIVISION.
PROGRAM-ID. KAFKAAPIS-BUILDER.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
REPOSITORY.
    COPY "KAFKA-COORDINATOR-TRANSACTION".
    COPY "KAFKA-NETWORK-REQUESTCHANNEL".
    COPY "KAFKA-SERVER-APIVERSIONMANAGER".
    COPY "KAFKA-SERVER-AUTOTOPICCREATIONMANAGER".
    COPY "KAFKA-SERVER-DELEGATIONTOKENMANAGER".
    COPY "KAFKA-SERVER-FETCHMANAGER".
    COPY "KAFKA-SERVER-FORWARDINGMANAGER".
    COPY "KAFKA-SERVER-KAFKAAPIS".
    COPY "KAFKA-SERVER-KAFKACONFIG".
    COPY "KAFKA-SERVER-METADATACACHE".
    COPY "KAFKA-SERVER-QUOTAFACTORY-QUOTAMANAGERS".
    COPY "KAFKA-SERVER-REPLICAMANAGER".
    COPY "KAFKA-SERVER-SHAREPARTITIONMANAGER".
    COPY "KAFKA-COORDINATOR-GROUP-GROUPCOORDINATOR".
    COPY "KAFKA-COORDINATOR-SHARE-SHARECOORDINATOR".
    COPY "KAFKA-METADATA-CONFIGREPOSITORY".
    COPY "KAFKA-SERVER-CLIENTMETRICSMANAGER".
    COPY "KAFKA-SERVER-AUTHORIZER".
    COPY "KAFKA-STORAGE-LOG-METRICS-BROKERTOPICSTATS".

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-REQUESTCHANNEL PIC X(30) VALUE SPACES.
01 WS-FORWARDINGMANAGER PIC X(30) VALUE SPACES.
01 WS-REPLICAMANAGER PIC X(30) VALUE SPACES.
01 WS-GROUPCOORDINATOR PIC X(30) VALUE SPACES.
01 WS-TXNCOORDINATOR PIC X(30) VALUE SPACES.
01 WS-SHARECOORDINATOR PIC X(30) VALUE SPACES.
01 WS-AUTOTOPICCREATIONMANAGER PIC X(30) VALUE SPACES.
01 WS-BROKERID PIC 9(9) VALUE 0.
01 WS-CONFIG PIC X(30) VALUE SPACES.
01 WS-CONFIGREPOSITORY PIC X(30) VALUE SPACES.
01 WS-METADATACACHE PIC X(30) VALUE SPACES.
01 WS-METRICS PIC X(30) VALUE SPACES.
01 WS-AUTHORIZER PIC X(30) VALUE SPACES.
01 WS-QUOTAS PIC X(30) VALUE SPACES.
01 WS-FETCHMANAGER PIC X(30) VALUE SPACES.
01 WS-SHAREPARTITIONMANAGER PIC X(30) VALUE SPACES.
01 WS-BROKERTOPICSTATS PIC X(30) VALUE SPACES.
01 WS-CLUSTERID PIC X(30) VALUE "clusterId".
01 WS-TIME PIC X(30) VALUE "SYSTEM".
01 WS-TOKENMANAGER PIC X(30) VALUE SPACES.
01 WS-APIVERSIONMANAGER PIC X(30) VALUE SPACES.
01 WS-CLIENTMETRICSMANAGER PIC X(30) VALUE SPACES.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    PERFORM SET-REQUESTCHANNEL
    PERFORM SET-FORWARDINGMANAGER
    PERFORM SET-REPLICAMANAGER
    PERFORM SET-GROUPCOORDINATOR
    PERFORM SET-TXNCOORDINATOR
    PERFORM SET-SHARECOORDINATOR
    PERFORM SET-AUTOTOPICCREATIONMANAGER
    PERFORM SET-BROKERID
    PERFORM SET-CONFIG
    PERFORM SET-CONFIGREPOSITORY
    PERFORM SET-METADATACACHE
    PERFORM SET-METRICS
    PERFORM SET-AUTHORIZER
    PERFORM SET-QUOTAS
    PERFORM SET-FETCHMANAGER
    PERFORM SET-SHAREPARTITIONMANAGER
    PERFORM SET-BROKERTOPICSTATS
    PERFORM SET-CLUSTERID
    PERFORM SET-TIME
    PERFORM SET-TOKENMANAGER
    PERFORM SET-APIVERSIONMANAGER
    PERFORM SET-CLIENTMETRICSMANAGER
    PERFORM BUILD-KAFKAAPIS.

SET-REQUESTCHANNEL.
    MOVE "REQUEST-CHANNEL" TO WS-REQUESTCHANNEL.

SET-FORWARDINGMANAGER.
    MOVE "FORWARDING-MANAGER" TO WS-FORWARDINGMANAGER.

SET-REPLICAMANAGER.
    MOVE "REPLICA-MANAGER" TO WS-REPLICAMANAGER.

SET-GROUPCOORDINATOR.
    MOVE "GROUP-COORDINATOR" TO WS-GROUPCOORDINATOR.

SET-TXNCOORDINATOR.
    MOVE "TXN-COORDINATOR" TO WS-TXNCOORDINATOR.

SET-SHARECOORDINATOR.
    MOVE "SHARE-COORDINATOR" TO WS-SHARECOORDINATOR.

SET-AUTOTOPICCREATIONMANAGER.
    MOVE "AUTO-TOPIC-CREATION-MANAGER" TO WS-AUTOTOPICCREATIONMANAGER.

SET-BROKERID.
    MOVE 0 TO WS-BROKERID.

SET-CONFIG.
    MOVE "KAFKA-CONFIG" TO WS-CONFIG.

SET-CONFIGREPOSITORY.
    MOVE "CONFIG-REPOSITORY" TO WS-CONFIGREPOSITORY.

SET-METADATACACHE.
    MOVE "METADATA-CACHE" TO WS-METADATACACHE.

SET-METRICS.
    MOVE "METRICS" TO WS-METRICS.

SET-AUTHORIZER.
    MOVE "AUTHORIZER" TO WS-AUTHORIZER.

SET-QUOTAS.
    MOVE "QUOTAS" TO WS-QUOTAS.

SET-FETCHMANAGER.
    MOVE "FETCH-MANAGER" TO WS-FETCHMANAGER.

SET-SHAREPARTITIONMANAGER.
    MOVE "SHARE-PARTITION-MANAGER" TO WS-SHAREPARTITIONMANAGER.

SET-BROKERTOPICSTATS.
    MOVE "BROKER-TOPIC-STATS" TO WS-BROKERTOPICSTATS.

SET-CLUSTERID.
    MOVE "clusterId" TO WS-CLUSTERID.

SET-TIME.
    MOVE "SYSTEM" TO WS-TIME.

SET-TOKENMANAGER.
    MOVE "TOKEN-MANAGER" TO WS-TOKENMANAGER.

SET-APIVERSIONMANAGER.
    MOVE "API-VERSION-MANAGER" TO WS-APIVERSIONMANAGER.

SET-CLIENTMETRICSMANAGER.
    MOVE "CLIENT-METRICS-MANAGER" TO WS-CLIENTMETRICSMANAGER.

BUILD-KAFKAAPIS.
    PERFORM CHECK-REQUESTCHANNEL
    PERFORM CHECK-FORWARDINGMANAGER
    PERFORM CHECK-REPLICAMANAGER
    PERFORM CHECK-GROUPCOORDINATOR
    PERFORM CHECK-TXNCOORDINATOR
    PERFORM CHECK-SHARECOORDINATOR
    PERFORM CHECK-AUTOTOPICCREATIONMANAGER
    PERFORM CHECK-CONFIG
    PERFORM CHECK-CONFIGREPOSITORY
    PERFORM CHECK-METADATACACHE
    PERFORM CHECK-METRICS
    PERFORM CHECK-AUTHORIZER
    PERFORM CHECK-QUOTAS
    PERFORM CHECK-FETCHMANAGER
    PERFORM CHECK-SHAREPARTITIONMANAGER
    PERFORM CHECK-CLIENTMETRICSMANAGER
    PERFORM CHECK-BROKERTOPICSTATS
    PERFORM CHECK-APIVERSIONMANAGER
    PERFORM CREATE-KAFKAAPIS.

CHECK-REQUESTCHANNEL.
    IF WS-REQUESTCHANNEL = SPACES
        RAISE EXCEPTION "you must set requestChannel".

CHECK-FORWARDINGMANAGER.
    IF WS-FORWARDINGMANAGER = SPACES
        RAISE EXCEPTION "you must set forwardingManager".

CHECK-REPLICAMANAGER.
    IF WS-REPLICAMANAGER = SPACES
        RAISE EXCEPTION "You must set replicaManager".

CHECK-GROUPCOORDINATOR.
    IF WS-GROUPCOORDINATOR = SPACES
        RAISE EXCEPTION "You must set groupCoordinator".

CHECK-TXNCOORDINATOR.
    IF WS-TXNCOORDINATOR = SPACES
        RAISE EXCEPTION "You must set txnCoordinator".

CHECK-SHARECOORDINATOR.
    IF WS-SHARECOORDINATOR = SPACES
        RAISE EXCEPTION "You must set shareCoordinator".

CHECK-AUTOTOPICCREATIONMANAGER.
    IF WS-AUTOTOPICCREATIONMANAGER = SPACES
        RAISE EXCEPTION "You must set autoTopicCreationManager".

CHECK-CONFIG.
    IF WS-CONFIG = SPACES
        MOVE "KAFKA-CONFIG" TO WS-CONFIG.

CHECK-CONFIGREPOSITORY.
    IF WS-CONFIGREPOSITORY = SPACES
        RAISE EXCEPTION "You must set configRepository".

CHECK-METADATACACHE.
    IF WS-METADATACACHE = SPACES
        RAISE EXCEPTION "You must set metadataCache".

CHECK-METRICS.
    IF WS-METRICS = SPACES
        RAISE EXCEPTION "You must set metrics".

CHECK-AUTHORIZER.
    IF WS-AUTHORIZER = SPACES
        RAISE EXCEPTION "You must set authorizer".

CHECK-QUOTAS.
    IF WS-QUOTAS = SPACES
        RAISE EXCEPTION "You must set quotas".

CHECK-FETCHMANAGER.
    IF WS-FETCHMANAGER = SPACES
        RAISE EXCEPTION "You must set fetchManager".

CHECK-SHAREPARTITIONMANAGER.
    IF WS-SHAREPARTITIONMANAGER = SPACES
        RAISE EXCEPTION "You must set sharePartitionManager".

CHECK-CLIENTMETRICSMANAGER.
    IF WS-CLIENTMETRICSMANAGER = SPACES
        RAISE EXCEPTION "You must set clientMetricsManager".

CHECK-BROKERTOPICSTATS.
    IF WS-BROKERTOPICSTATS = SPACES
        MOVE "BROKER-TOPIC-STATS" TO WS-BROKERTOPICSTATS.

CHECK-APIVERSIONMANAGER.
    IF WS-APIVERSIONMANAGER = SPACES
        RAISE EXCEPTION "You must set apiVersionManager".

CREATE-KAFKAAPIS.
    MOVE WS-REQUESTCHANNEL TO KAFKA-APIS-REQUESTCHANNEL
    MOVE WS-FORWARDINGMANAGER TO KAFKA-APIS-FORWARDINGMANAGER
    MOVE WS-REPLICAMANAGER TO KAFKA-APIS-REPLICAMANAGER
    MOVE WS-GROUPCOORDINATOR TO KAFKA-APIS-GROUPCOORDINATOR
    MOVE WS-TXNCOORDINATOR TO KAFKA-APIS-TXNCOORDINATOR
    MOVE WS-SHARECOORDINATOR TO KAFKA-APIS-SHARECOORDINATOR
    MOVE WS-AUTOTOPICCREATIONMANAGER TO KAFKA-APIS-AUTOTOPICCREATIONMANAGER
    MOVE WS-BROKERID TO KAFKA-APIS-BROKERID
    MOVE WS-CONFIG TO KAFKA-APIS-CONFIG
    MOVE WS-CONFIGREPOSITORY TO KAFKA-APIS-CONFIGREPOSITORY
    MOVE WS-METADATACACHE TO KAFKA-APIS-METADATACACHE
    MOVE WS-METRICS TO KAFKA-APIS-METRICS
    MOVE WS-AUTHORIZER TO KAFKA-APIS-AUTHORIZER
    MOVE WS-QUOTAS TO KAFKA-APIS-QUOTAS
    MOVE WS-FETCHMANAGER TO KAFKA-APIS-FETCHMANAGER
    MOVE WS-SHAREPARTITIONMANAGER TO KAFKA-APIS-SHAREPARTITIONMANAGER
    MOVE WS-BROKERTOPICSTATS TO KAFKA-APIS-BROKERTOPICSTATS
    MOVE WS-CLUSTERID TO KAFKA-APIS-CLUSTERID
    MOVE WS-TIME TO KAFKA-APIS-TIME
    MOVE WS-TOKENMANAGER TO KAFKA-APIS-TOKENMANAGER
    MOVE WS-APIVERSIONMANAGER TO KAFKA-APIS-APIVERSIONMANAGER
    MOVE WS-CLIENTMETRICSMANAGER TO KAFKA-APIS-CLIENTMETRICSMANAGER
    CALL "CREATE-KAFKAAPIS" USING KAFKA-APIS-REQUESTCHANNEL,
                             KAFKA-APIS-FORWARDINGMANAGER,
                             KAFKA-APIS-REPLICAMANAGER,
                             KAFKA-APIS-GROUPCOORDINATOR,
                             KAFKA-APIS-TXNCOORDINATOR,
                             KAFKA-APIS-SHARECOORDINATOR,
                             KAFKA-APIS-AUTOTOPICCREATIONMANAGER,
                             KAFKA-APIS-BROKERID,
                             KAFKA-APIS-CONFIG,
                             KAFKA-APIS-CONFIGREPOSITORY,
                             KAFKA-APIS-METADATACACHE,
                             KAFKA-APIS-METRICS,
                             KAFKA-APIS-AUTHORIZER,
                             KAFKA-APIS-QUOTAS,
                             KAFKA-APIS-FETCHMANAGER,
                             KAFKA-APIS-SHAREPARTITIONMANAGER,
                             KAFKA-APIS-BROKERTOPICSTATS,
                             KAFKA-APIS-CLUSTERID,
                             KAFKA-APIS-TIME,
                             KAFKA-APIS-TOKENMANAGER,
                             KAFKA-APIS-APIVERSIONMANAGER,
                             KAFKA-APIS-CLIENTMETRICSMANAGER.

STOP RUN.