IDENTIFICATION DIVISION.
PROGRAM-ID. DELAYED-SYNC.
AUTHOR. YOUR-NAME.
DATE-WRITTEN. CURRENT-DATE.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 COORDINATOR PIC X(10).
01 GROUP PIC X(10).
01 GENERATION-ID PIC 9(9).
01 REBALANCE-TIMEOUT-MS PIC 9(9) COMP.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    MOVE COORDINATOR TO COORDINATOR.
    MOVE GROUP TO GROUP.
    MOVE GENERATIONID TO GENERATION-ID.
    MOVE REBALANCETIMEOUTMS TO REBALANCE-TIMEOUT-MS.

    CALL "TRY-COMPLETE" USING COORDINATOR, GROUP, GENERATION-ID, FORCE-COMPLETE.

    CALL "ON-EXPIRATION" USING COORDINATOR, GROUP, GENERATION-ID.

    CALL "ON-COMPLETE".

    STOP RUN.

TRY-COMPLETE SECTION.
    *> Implementation of tryComplete()
    MOVE 0 TO RETURN-CODE.
    RETURN.

ON-EXPIRATION SECTION.
    *> Implementation of onExpiration()
    MOVE 0 TO RETURN-CODE.
    RETURN.

ON-COMPLETE SECTION.
    *> Implementation of onComplete()
    MOVE 0 TO RETURN-CODE.
    RETURN.

FORCE-COMPLETE SECTION.
    *> Implementation of forceComplete
    MOVE 0 TO RETURN-CODE.
    RETURN.