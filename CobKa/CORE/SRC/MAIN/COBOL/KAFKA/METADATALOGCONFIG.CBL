IDENTIFICATION DIVISION.
PROGRAM-ID. METADATA-LOG-CONFIG.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
REPOSITORY.
    COPY "KAFKA-SERVER-CONFIG".

DATA DIVISION.
WORKING-STORAGE SECTION.
01 METADATA-LOG-CONFIG.
   05 LOG-SEGMENT-BYTES        PIC 9(9) VALUE ZEROS.
   05 LOG-SEGMENT-MIN-BYTES    PIC 9(9) VALUE ZEROS.
   05 LOG-SEGMENT-MILLIS       PIC 9(18) VALUE ZEROS.
   05 RETENTION-MAX-BYTES      PIC 9(18) VALUE ZEROS.
   05 RETENTION-MILLIS         PIC 9(18) VALUE ZEROS.
   05 MAX-BATCH-SIZE-IN-BYTES  PIC 9(9) VALUE ZEROS.
   05 MAX-FETCH-SIZE-IN-BYTES  PIC 9(9) VALUE ZEROS.
   05 FILE-DELETE-DELAY-MS     PIC 9(18) VALUE ZEROS.
   05 NODE-ID                  PIC 9(9) VALUE ZEROS.

PROCEDURE DIVISION.
METADATA-LOG-CONFIG-INIT.
    MOVE METADATA-LOG-SEGMENT-BYTES       TO LOG-SEGMENT-BYTES
    MOVE METADATA-LOG-SEGMENT-MIN-BYTES   TO LOG-SEGMENT-MIN-BYTES
    MOVE METADATA-LOG-SEGMENT-MILLIS      TO LOG-SEGMENT-MILLIS
    MOVE METADATA-RETENTION-BYTES         TO RETENTION-MAX-BYTES
    MOVE METADATA-RETENTION-MILLIS        TO RETENTION-MILLIS
    MOVE MAX-BATCH-SIZE-IN-BYTES          TO MAX-BATCH-SIZE-IN-BYTES
    MOVE MAX-FETCH-SIZE-IN-BYTES          TO MAX-FETCH-SIZE-IN-BYTES
    MOVE LOG-DELETE-DELAY-MS-DEFAULT      TO FILE-DELETE-DELAY-MS
    MOVE METADATA-NODE-ID-CONFIG          TO NODE-ID.

STOP RUN.